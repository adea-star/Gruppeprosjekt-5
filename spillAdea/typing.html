<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KodeReisen</title>
    <link rel="stylesheet" href="spillstyle.css"> <!-- Link to the external stylesheet -->
    <style>
        canvas {
            border: 2px solid #333;
            background-image: url('images/typing.jpg');
            background-size: cover;
            background-position: center;
            width: 100%;
            max-width: 900px;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        input[type="text"] {
            padding: 10px;
            font-size: 18px;
            border-radius: 5px;
            border: 1px solid #555;
            width: 100%;
            max-width: 300px;
            text-align: center;
            background-color: #333;
            color: white;
            box-shadow: 0px 0px 10px rgba(0, 0, 50, 0.5);
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #00bfff;
        }
    </style>
</head>
<body>
    <div id="velgValgene" class="valgene">
        <h2>Kapitell: 4 </h2>
        <p>Før eksamen faller ordene ned i hodet konstant. Kan du skrive fort nok før ordene faller ut av arket videre i universet? <br> Velg en av valgene:</p>
        <div class="toValg">
            <button onclick="startSpill('enkelt')">Du sitter i flere timer å øver før eksamen.</button>
            <button onclick="startSpill('vanskelig')">Du øver ikke mye siden det er første eksamen.</button>
        </div>
    </div>

    <div class="spillOmrade" id="spillOversikt" style="display: none;">
        <canvas id="spillCanvas" width="1200" height="630"></canvas>
    </div>

    <div class="informasjon">
        <div class="tittel">
            <span class="kode">Kode</span><span class="reisen">Reisen</span>
        </div>
        <input type="text" id="ordene" placeholder="Skriv ordene her" autofocus />
        <div class="infoOversikt" id="infoOversikt">
            <h2>Lives: 3 | Score: 0</h2>
        </div>
    </div>

<script>
    const canvas = document.getElementById('spillCanvas');
    const ctx = canvas.getContext('2d');
    const textInput = document.getElementById('ordene');
    const infoDisplay = document.getElementById('infoOversikt');
    const velgValgene = document.getElementById('velgValgene');
    const spillOversikt = document.getElementById('spillOversikt');

    let ord = [];
    let poeng = 0;
    let liv = 3;
    let animationFrame;
    let kodeOrdene = [
        "flexbox", "grid", "media-query", "hover", "transition",
        "animation", "transform", "background-color", "border-radius",
        "function", "array", "object", "eventListener",
        "div", "span", "input", "form"
    ];
    let spillHastighet = 1;

    function startSpill(difficulty) {
        velgValgene.style.display = 'none';
        spillOversikt.style.display = 'flex';
        if (difficulty === 'vanskelig') {
            liv = 1;
            spillHastighet = 4; // Faster falling speed
        } else {
            liv = 3;
            spillHastighet = 1; // Normal falling speed
        }
        begynnSpill();
    }

    function begynnSpill() {
        ord = [];
        poeng = 0;
        infoDisplay.innerHTML = `<h2>Lives: ${liv} | Score: ${poeng}</h2>`;
        giKodeOrdene();
        animationFrame = window.requestAnimationFrame(loop);
    }

    class Ordene {
        constructor(ordene, x) {
            this.ordene = ordene;
            this.guessed = false;
            this.x = x;
            this.y = 0;
            this.bottom = false;
        }

        tegn() {
            ctx.fillStyle = 'black';
            ctx.font = '24px Arial';
            ctx.fillText(this.ordene, this.x, this.y);
        }

        beveg() {
            this.y += spillHastighet;
            if (this.y > canvas.height) {
                this.bottom = true;
            }
        }
    }

    function checkInput() {
        for (let i = 0; i < ord.length; i++) {
            if (textInput.value === ord[i].ordene) {
                poeng++;
                ord.splice(i, 1);
                textInput.value = "";
                giKodeOrdene();
                break;
            }
        }

        if (poeng >= 10) {
            window.location.href = 'universe.html'; 
        }
    }

    function giKodeOrdene() {
        if (kodeOrdene.length > 0) {
            const wIndex = Math.floor(Math.random() * kodeOrdene.length);
            const randX = Math.floor(Math.random() * (canvas.width - 100));
            const ordene = new Ordene(kodeOrdene[wIndex], randX);
            ord.push(ordene);
            kodeOrdene.splice(wIndex, 1);
        }
    }

    function sluttSpill(message) {
        window.cancelAnimationFrame(animationFrame); 
        if (message === "Game Over") {
            window.location.href = 'gang.html'; 
        }
    }

    function loop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ord.forEach((o, index) => {
            o.tegn();
            o.beveg();
            if (o.bottom) {
                liv--;
                ord.splice(index, 1);
                if (liv <= 0) {
                    sluttSpill("Game Over");
                }
            }
        });

        if (ord.length === 0 && kodeOrdene.length > 0) {
            giKodeOrdene();
        }

        infoDisplay.innerHTML = `<h2>Lives: ${liv} | Score: ${poeng}</h2>`;
        animationFrame = window.requestAnimationFrame(loop);
    }

    textInput.addEventListener('input', checkInput);
</script>
</body>
</html>
